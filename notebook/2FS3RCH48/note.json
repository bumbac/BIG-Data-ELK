{
  "paragraphs": [
    {
      "text": "import org.apache.spark.sql.functions",
      "user": "anonymous",
      "dateUpdated": "2020-12-03 13:31:33.228",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.functions\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1606819436121_1625227343",
      "id": "20201201-104356_179187025",
      "dateCreated": "2020-12-01 10:43:56.121",
      "dateStarted": "2020-12-03 13:31:33.273",
      "dateFinished": "2020-12-03 13:31:33.488",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val hole0 \u003d spark.read.format(\"csv\")\n  .option(\"sep\", \";\")\n  .option(\"inferSchema\", \"true\")\n  .option(\"header\", \"true\")\n  .option(\"encoding\", \"cp1250\")\n  .load(\"ptp_linescanparovane-2019.csv\")\n\nval hole \u003d hole0.withColumnRenamed(\"usek\", \"usekID\").withColumnRenamed(\"cisloCk\", \"Číslo CK\")\n  \nval sec0 \u003d spark.read.format(\"csv\")\n  .option(\"sep\", \";\")\n  .option(\"inferSchema\", \"true\")\n  .option(\"header\", \"true\")\n  .option(\"encoding\", \"cp1250\")\n  .load(\"rs_utriedeneuseky_2020-01-01.csv\")\n  \nval sec \u003d sec0.withColumnRenamed(\"Trieda cesty\", \"TriedaCK\").withColumnRenamed(\"Číslo cesty\", \"Číslo CK\").withColumnRenamed(\"ID_Useku\", \"usekID\")\n  \nval road0 \u003d spark.read.format(\"csv\")\n  .option(\"sep\", \";\")\n  .option(\"inferSchema\", \"true\")\n  .option(\"header\", \"true\")\n  .option(\"encoding\", \"cp1250\")\n  .load(\"pasportplochy_sr_2020-01-01.csv\")\n\nval road \u003d road0.withColumnRenamed(\"Trieda CK\", \"TriedaCK\").withColumnRenamed(\"úsek ID\", \"usekID\")\n\nval UCI \u003d Seq(\n        (5.0, 1, \"výborný stav\"),\n        (10.0, 2, \"veľmi dobrý stav\"),\n        (19.0, 3, \"vyhovujúci stav\"),\n        (30.0, 4, \"nevyhovujúci stav\"),\n        (1000.0, 5, \"havarijný stav\")\n    ).toDF(\"UCI\", \"Class\", \"Rating\")",
      "user": "anonymous",
      "dateUpdated": "2020-12-03 13:31:33.573",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "hole0: org.apache.spark.sql.DataFrame \u003d [TriedaCK: string, cisloCk: string ... 24 more fields]\nhole: org.apache.spark.sql.DataFrame \u003d [TriedaCK: string, Číslo CK: string ... 24 more fields]\nsec0: org.apache.spark.sql.DataFrame \u003d [Trieda cesty: string, Číslo cesty: string ... 28 more fields]\nsec: org.apache.spark.sql.DataFrame \u003d [TriedaCK: string, Číslo CK: string ... 28 more fields]\nroad0: org.apache.spark.sql.DataFrame \u003d [Trieda CK: string, Číslo CK: string ... 26 more fields]\nroad: org.apache.spark.sql.DataFrame \u003d [TriedaCK: string, Číslo CK: string ... 26 more fields]\nUCI: org.apache.spark.sql.DataFrame \u003d [UCI: double, Class: int ... 1 more field]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://c30c9a123428:4040/jobs/job?id\u003d13",
            "http://c30c9a123428:4040/jobs/job?id\u003d14",
            "http://c30c9a123428:4040/jobs/job?id\u003d15",
            "http://c30c9a123428:4040/jobs/job?id\u003d16",
            "http://c30c9a123428:4040/jobs/job?id\u003d17",
            "http://c30c9a123428:4040/jobs/job?id\u003d18"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1606727073563_-8972653",
      "id": "20201130-090433_271036724",
      "dateCreated": "2020-11-30 09:04:33.563",
      "dateStarted": "2020-12-03 13:31:33.641",
      "dateFinished": "2020-12-03 13:31:35.305",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "val usefulColumnsSec \u003d List(\"usekID\", \"TriedaCK\", \"Číslo CK\", \"Typ úseku\", \"Kraj\", \"Okres\", \"Dopravný smer\", \"Funkčná klasifikácia\", \"StavebnaKategoria\", \"prejazdovaDlzka\", \"Spravca_Skratka\", \"Vlastnik_Skratka\")\nval usefulColumnsRoad \u003d List(\"usekID\", \"dĺžka vozovky (m)\", \"šírka vozovky\", \"typKrytuVozovky\")\nvar usefulColumnsHole \u003d List(\"usekID\", \"UsekoveStaniceZaciatku\", \"UsekoveStanicenieKonca\", \"UciMax\", \"UciPriem\", \"DatumZberu\", \"Krok merania / m\")\nval usefulSec \u003d sec.select(usefulColumnsSec.head, usefulColumnsSec.tail: _*)\nval usefulRoad \u003d road.select(usefulColumnsRoad.head, usefulColumnsRoad.tail: _*)\nvar usefulHole \u003d hole.select(usefulColumnsHole.head, usefulColumnsHole.tail: _*).filter($\"UciPriem\" \u003e 19)",
      "user": "anonymous",
      "dateUpdated": "2020-12-03 13:31:35.342",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "title": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "usefulColumnsSec: List[String] \u003d List(usekID, TriedaCK, Číslo CK, Typ úseku, Kraj, Okres, Dopravný smer, Funkčná klasifikácia, StavebnaKategoria, prejazdovaDlzka, Spravca_Skratka, Vlastnik_Skratka)\nusefulColumnsRoad: List[String] \u003d List(usekID, dĺžka vozovky (m), šírka vozovky, typKrytuVozovky)\nusefulColumnsHole: List[String] \u003d List(usekID, UsekoveStaniceZaciatku, UsekoveStanicenieKonca, UciMax, UciPriem, DatumZberu, Krok merania / m)\nusefulSec: org.apache.spark.sql.DataFrame \u003d [usekID: int, TriedaCK: string ... 10 more fields]\nusefulRoad: org.apache.spark.sql.DataFrame \u003d [usekID: int, dĺžka vozovky (m): int ... 2 more fields]\nusefulHole: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [usekID: int, UsekoveStaniceZaciatku: int ... 5 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1606748047727_-330072770",
      "id": "20201130-145407_622593832",
      "dateCreated": "2020-11-30 14:54:07.727",
      "dateStarted": "2020-12-03 13:31:35.387",
      "dateFinished": "2020-12-03 13:31:35.828",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "import org.apache.spark.sql.functions.udf\nval uciToClass \u003d (uci: Int) \u003d\u003e \n                             uci match {\n                                        case it if 0 until 5 contains it  \u003d\u003e 1\n                                        case it if 5 until 10 contains it  \u003d\u003e 2\n                                        case it if 10 until 19 contains it  \u003d\u003e 3\n                                        case it if 19 until 30 contains it  \u003d\u003e 4\n                                        case _ \u003d\u003e 5\n                                        }\n                         \n                          \nval classToRating \u003d (uciclass: Int) \u003d\u003e\n                             uciclass match {\n                                        case 1 \u003d\u003e \"výborný stav\"\n                                        case 2 \u003d\u003e \"veľmi dobrý stav\"\n                                        case 3 \u003d\u003e \"vyhovujúci stav\"\n                                        case 4 \u003d\u003e \"nevyhovujúci stav\"\n                                        case 5 \u003d\u003e \"havarijný stav\"\n                                        case _  \u003d\u003e null\n                                          }",
      "user": "anonymous",
      "dateUpdated": "2020-12-03 13:31:35.887",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.functions.udf\nuciToClass: Int \u003d\u003e Int \u003d \u003cfunction1\u003e\nclassToRating: Int \u003d\u003e String \u003d \u003cfunction1\u003e\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1606820383911_-232106385",
      "id": "20201201-105943_2096195260",
      "dateCreated": "2020-12-01 10:59:43.911",
      "dateStarted": "2020-12-03 13:31:35.930",
      "dateFinished": "2020-12-03 13:31:36.307",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// vytvořit nový dataset, který bude agregovat data z jednoho původního datasetu\nval uciclass \u003d udf(uciToClass)\nval rating \u003d udf(classToRating)\n\nval critical \u003d usefulHole.groupBy(\"usekID\", \"DatumZberu\").agg(\n    functions.max(\"UciPriem\").as(\"MaxUciPriemer\"),\n    functions.avg(\"UciPriem\").as(\"UciPriemer\")).withColumn(\"Rating\", rating(uciclass($\"UciPriemer\"))).sort(\"DatumZberu\")\ncritical.show(1000)",
      "user": "anonymous",
      "dateUpdated": "2020-12-03 13:31:36.330",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+----------+-------------+------------------+-----------------+\n| usekID|DatumZberu|MaxUciPriemer|        UciPriemer|           Rating|\n+-------+----------+-------------+------------------+-----------------+\n|   1394|  1.8.2019|           28|              25.0|nevyhovujúci stav|\n| 289478|  1.8.2019|           33|29.333333333333332|nevyhovujúci stav|\n| 289893|  1.8.2019|           29|              25.0|nevyhovujúci stav|\n|    829|  1.8.2019|           40|31.666666666666668|   havarijný stav|\n| 289894|  1.8.2019|           21|              21.0|nevyhovujúci stav|\n|    792|  1.8.2019|           37|              32.5|   havarijný stav|\n| 367358| 15.7.2019|           32|              32.0|   havarijný stav|\n|   1671| 15.7.2019|           38|              30.0|   havarijný stav|\n| 367359| 15.7.2019|           43|              36.0|   havarijný stav|\n|   1674| 15.7.2019|           53|              32.5|   havarijný stav|\n| 470127| 19.6.2019|           31|26.666666666666668|nevyhovujúci stav|\n|   1917| 19.6.2019|           42|              42.0|   havarijný stav|\n|   1895| 19.6.2019|           22|              22.0|nevyhovujúci stav|\n|   1969| 19.6.2019|           57|49.333333333333336|   havarijný stav|\n| 927300| 19.6.2019|           24|              24.0|nevyhovujúci stav|\n|   1998| 19.6.2019|           45|              43.0|   havarijný stav|\n|   1926| 19.6.2019|           35|              35.0|   havarijný stav|\n|   1914| 19.6.2019|           45|              38.8|   havarijný stav|\n| 367418| 19.9.2019|           60|34.526315789473685|   havarijný stav|\n| 367430| 19.9.2019|           25|              23.0|nevyhovujúci stav|\n| 369240| 19.9.2019|           27|              27.0|nevyhovujúci stav|\n| 367427| 19.9.2019|           27|              27.0|nevyhovujúci stav|\n|   7070| 19.9.2019|           45|              32.0|   havarijný stav|\n| 418515| 19.9.2019|           26|              26.0|nevyhovujúci stav|\n| 992693| 19.9.2019|           38|              32.0|   havarijný stav|\n| 367279| 19.9.2019|           34|             27.75|nevyhovujúci stav|\n| 369235| 19.9.2019|           56|              56.0|   havarijný stav|\n|   1679| 19.9.2019|           51|              51.0|   havarijný stav|\n| 418512| 19.9.2019|           21|              21.0|nevyhovujúci stav|\n| 367431| 19.9.2019|           59|29.285714285714285|nevyhovujúci stav|\n| 992694| 19.9.2019|           68|              51.5|   havarijný stav|\n| 928550| 19.9.2019|           35| 26.23076923076923|nevyhovujúci stav|\n| 418338| 19.9.2019|           52|              52.0|   havarijný stav|\n| 367423| 19.9.2019|           40|              40.0|   havarijný stav|\n| 416414| 19.9.2019|           24|              24.0|nevyhovujúci stav|\n|   9055| 19.9.2019|           24|              24.0|nevyhovujúci stav|\n| 418337| 19.9.2019|           31|              31.0|   havarijný stav|\n| 416413| 19.9.2019|           43|              43.0|   havarijný stav|\n| 416415| 19.9.2019|           24|              22.0|nevyhovujúci stav|\n| 418341| 19.9.2019|           25|              25.0|nevyhovujúci stav|\n| 367278| 19.9.2019|           21|              21.0|nevyhovujúci stav|\n| 416416| 19.9.2019|           44|              36.5|   havarijný stav|\n| 416454| 20.9.2019|           59|51.666666666666664|   havarijný stav|\n|   2108| 20.9.2019|           58|51.333333333333336|   havarijný stav|\n|   2085| 20.9.2019|           46|             34.75|   havarijný stav|\n| 418435| 20.9.2019|           65|              57.5|   havarijný stav|\n| 416388| 20.9.2019|           67|63.833333333333336|   havarijný stav|\n| 926892| 20.9.2019|           46|43.666666666666664|   havarijný stav|\n|1022238| 20.9.2019|           54|              54.0|   havarijný stav|\n| 416387| 20.9.2019|           68| 56.18181818181818|   havarijný stav|\n| 418437| 20.9.2019|           67|              53.0|   havarijný stav|\n|   9061| 20.9.2019|           51|              41.6|   havarijný stav|\n|   2208| 20.9.2019|           49|              49.0|   havarijný stav|\n| 418270| 20.9.2019|           47|              47.0|   havarijný stav|\n| 416386| 20.9.2019|           49|              49.0|   havarijný stav|\n|   1691| 20.9.2019|           22|              22.0|nevyhovujúci stav|\n|   2111| 20.9.2019|           61|46.833333333333336|   havarijný stav|\n| 418269| 20.9.2019|           47|              44.0|   havarijný stav|\n| 418268| 20.9.2019|           32|              32.0|   havarijný stav|\n| 416389| 20.9.2019|           80| 58.35294117647059|   havarijný stav|\n| 418436| 20.9.2019|           57|              57.0|   havarijný stav|\n|   2207| 20.9.2019|           61| 53.69230769230769|   havarijný stav|\n| 367361| 20.9.2019|           35|             25.75|nevyhovujúci stav|\n| 416385| 20.9.2019|           45|              45.0|   havarijný stav|\n| 926894| 20.9.2019|           37|              27.8|nevyhovujúci stav|\n| 290542| 26.8.2019|           60|              53.0|   havarijný stav|\n|    918| 26.8.2019|           62|             53.75|   havarijný stav|\n| 289954| 26.8.2019|           70|42.333333333333336|   havarijný stav|\n| 289819| 26.8.2019|           64|              64.0|   havarijný stav|\n| 289816| 26.8.2019|           67|              67.0|   havarijný stav|\n|   1436| 26.8.2019|           86| 81.66666666666667|   havarijný stav|\n| 290546| 26.8.2019|           27|              27.0|nevyhovujúci stav|\n|    832| 26.8.2019|           39|              39.0|   havarijný stav|\n| 289957| 26.8.2019|           84|              83.0|   havarijný stav|\n| 289815| 26.8.2019|           69|              69.0|   havarijný stav|\n| 289677| 26.8.2019|           72|              68.5|   havarijný stav|\n| 289956| 26.8.2019|           71|              71.0|   havarijný stav|\n|   1417| 26.8.2019|           56|             35.25|   havarijný stav|\n| 290541| 26.8.2019|           61|43.666666666666664|   havarijný stav|\n| 289814| 26.8.2019|           65|59.333333333333336|   havarijný stav|\n| 290135| 26.8.2019|           20|              20.0|nevyhovujúci stav|\n| 289823| 26.8.2019|           62|              53.0|   havarijný stav|\n| 289820| 26.8.2019|           80|            66.125|   havarijný stav|\n| 290119| 26.8.2019|           20|              20.0|nevyhovujúci stav|\n| 289483| 26.8.2019|           81| 66.54545454545455|   havarijný stav|\n|    916| 26.8.2019|           44|              44.0|   havarijný stav|\n| 289821| 26.8.2019|           80|              66.0|   havarijný stav|\n| 289955| 26.8.2019|           66|              66.0|   havarijný stav|\n|    914| 26.8.2019|           81|              71.5|   havarijný stav|\n| 289822| 26.8.2019|           66|              61.0|   havarijný stav|\n| 289674| 26.8.2019|           72|              68.0|   havarijný stav|\n|   1435| 26.8.2019|           62|              59.0|   havarijný stav|\n|   1421| 26.8.2019|           49|              47.0|   havarijný stav|\n| 367484|27.11.2019|           51|              43.6|   havarijný stav|\n|   7071|27.11.2019|           53|            40.625|   havarijný stav|\n| 418489| 4.12.2019|           25|              25.0|nevyhovujúci stav|\n|   2088| 4.12.2019|           35|             29.75|nevyhovujúci stav|\n| 418490| 4.12.2019|           45|              42.0|   havarijný stav|\n|   7074| 4.12.2019|           84| 71.53846153846153|   havarijný stav|\n| 418488| 4.12.2019|           30|              30.0|   havarijný stav|\n| 289896|  5.8.2019|           24|22.666666666666668|nevyhovujúci stav|\n|  92191|  5.9.2019|           25|              22.5|nevyhovujúci stav|\n|  92972|  5.9.2019|           24|              23.0|nevyhovujúci stav|\n|  92189|  5.9.2019|           21|              21.0|nevyhovujúci stav|\n|   2211|  6.8.2019|           67|              61.5|   havarijný stav|\n| 370752|  6.8.2019|           35|              35.0|   havarijný stav|\n|   2107|  6.8.2019|           29|              29.0|nevyhovujúci stav|\n| 369209|  6.8.2019|           63| 48.42857142857143|   havarijný stav|\n| 290102|  6.8.2019|           38|             34.75|   havarijný stav|\n| 369210|  6.8.2019|           36|              33.4|   havarijný stav|\n| 369215|  6.8.2019|           52|             48.75|   havarijný stav|\n| 369191|  6.8.2019|           36|              25.8|nevyhovujúci stav|\n| 418392|  6.8.2019|           54|              40.5|   havarijný stav|\n|   2100|  6.8.2019|           56|36.666666666666664|   havarijný stav|\n| 369212|  6.8.2019|           37|             33.75|   havarijný stav|\n| 369211|  6.8.2019|           41|              36.0|   havarijný stav|\n| 369230|  6.8.2019|           28|              24.5|nevyhovujúci stav|\n| 418299|  6.8.2019|           44|              44.0|   havarijný stav|\n| 369220|  6.8.2019|           42|              42.0|   havarijný stav|\n| 369184|  6.8.2019|           20|              20.0|nevyhovujúci stav|\n| 367506|  6.8.2019|           24|              24.0|nevyhovujúci stav|\n| 369213|  6.8.2019|           43|              43.0|   havarijný stav|\n| 369232|  6.8.2019|           21|              21.0|nevyhovujúci stav|\n|   1720|  6.8.2019|           35|              30.5|   havarijný stav|\n| 369214|  6.8.2019|           36|              36.0|   havarijný stav|\n| 369219|  6.8.2019|           32|              29.0|nevyhovujúci stav|\n|   1391|  6.8.2019|           37|34.666666666666664|   havarijný stav|\n|   1389|  6.8.2019|           34|              34.0|   havarijný stav|\n| 369180|  6.8.2019|           20|              20.0|nevyhovujúci stav|\n| 367507|  6.8.2019|           26|              24.0|nevyhovujúci stav|\n| 369225|  6.8.2019|           59|47.166666666666664|   havarijný stav|\n| 916986|  6.8.2019|           46|              45.0|   havarijný stav|\n| 369228|  6.8.2019|           20|              20.0|nevyhovujúci stav|\n| 369193|  6.8.2019|           25|              22.0|nevyhovujúci stav|\n| 369227|  6.8.2019|           37|30.666666666666668|   havarijný stav|\n|   1735|  6.8.2019|           36|              33.0|   havarijný stav|\n|   1461|  6.8.2019|           29|              29.0|nevyhovujúci stav|\n|   7226|  9.7.2019|           36|              36.0|   havarijný stav|\n+-------+----------+-------------+------------------+-----------------+\n\nuciclass: org.apache.spark.sql.expressions.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction1\u003e,IntegerType,Some(List(IntegerType)))\nrating: org.apache.spark.sql.expressions.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction1\u003e,StringType,Some(List(IntegerType)))\ncritical: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] \u003d [usekID: int, DatumZberu: string ... 3 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://c30c9a123428:4040/jobs/job?id\u003d19"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1606819116606_-1915142798",
      "id": "20201201-103836_1739995779",
      "dateCreated": "2020-12-01 10:38:36.606",
      "dateStarted": "2020-12-03 13:31:36.406",
      "dateFinished": "2020-12-03 13:31:37.676",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "//vytvořit nový dataset, který bude agregovat data ze dvou původních datasetů najednou\nval detailedRoad \u003d usefulSec.join(usefulRoad, usingColumns\u003dSeq(\"usekID\"), joinType \u003d \"right\")\ndetailedRoad.show()",
      "user": "anonymous",
      "dateUpdated": "2020-12-03 13:31:37.711",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+-----------------+--------+-----------------+-----------------+---------------+--------------------+--------------------+--------------------+---------------+---------------+----------------+-----------------+-------------+---------------+\n|usekID|         TriedaCK|Číslo CK|        Typ úseku|             Kraj|          Okres|       Dopravný smer|Funkčná klasifikácia|   StavebnaKategoria|prejazdovaDlzka|Spravca_Skratka|Vlastnik_Skratka|dĺžka vozovky (m)|šírka vozovky|typKrytuVozovky|\n+------+-----------------+--------+-----------------+-----------------+---------------+--------------------+--------------------+--------------------+---------------+---------------+----------------+-----------------+-------------+---------------+\n|   148|cesta III. triedy|    1115|medzikrižovatkový|Bratislavský kraj|        Malacky|oba dopravné smer...|       podregionálny|     Krajinská cesta|            689|          RC BA|           BA SK|              686|          6,5|     bitúmenová|\n|   148|cesta III. triedy|    1115|medzikrižovatkový|Bratislavský kraj|        Malacky|oba dopravné smer...|       podregionálny|     Krajinská cesta|            689|          RC BA|           BA SK|                0|         null|     bitúmenová|\n|   148|cesta III. triedy|    1115|medzikrižovatkový|Bratislavský kraj|        Malacky|oba dopravné smer...|       podregionálny|     Krajinská cesta|            689|          RC BA|           BA SK|                0|         null|     bitúmenová|\n|   463| cesta II. triedy|     502|medzikrižovatkový|    Trnavský kraj|       Piešťany|oba dopravné smer...|          regionálny|     Krajinská cesta|            670|  SUC TTSK - TT|           TT SK|              670|            6|     bitúmenová|\n|   463| cesta II. triedy|     502|medzikrižovatkový|    Trnavský kraj|       Piešťany|oba dopravné smer...|          regionálny|     Krajinská cesta|            670|  SUC TTSK - TT|           TT SK|                0|         null|     bitúmenová|\n|   471| cesta II. triedy|     502|medzikrižovatkový|    Trnavský kraj|         Trnava|oba dopravné smer...|          regionálny|     Krajinská cesta|           2099|  SUC TTSK - TT|           TT SK|             2099|          6,5|     bitúmenová|\n|   496| cesta II. triedy|     502|medzikrižovatkový|    Trnavský kraj|         Trnava|oba dopravné smer...|          regionálny|Hlavná miestna cesta|            154|  SUC TTSK - TT|           TT SK|              154|          6,5|     bitúmenová|\n|   833|cesta III. triedy|    1381|medzikrižovatkový|    Trnavský kraj|Dunajská Streda|oba dopravné smer...|       podregionálny|     Krajinská cesta|            247|  SUC TTSK - DS|           TT SK|              241|          6,3|     bitúmenová|\n|   833|cesta III. triedy|    1381|medzikrižovatkový|    Trnavský kraj|Dunajská Streda|oba dopravné smer...|       podregionálny|     Krajinská cesta|            247|  SUC TTSK - DS|           TT SK|                0|         null|     bitúmenová|\n|  1088| cesta II. triedy|     514|medzikrižovatkový|    Trnavský kraj|       Hlohovec|oba dopravné smer...|          regionálny|     Krajinská cesta|           1121|  SUC TTSK - TT|           TT SK|             1121|            7|     bitúmenová|\n|  1238|  cesta I. triedy|      62|medzikrižovatkový|    Trnavský kraj|        Galanta|oba dopravné smer...|       nadregionálny|     Krajinská cesta|           1038|  SSC - IVSC BA|            STAT|                6|           11|     bitúmenová|\n|  1238|  cesta I. triedy|      62|medzikrižovatkový|    Trnavský kraj|        Galanta|oba dopravné smer...|       nadregionálny|     Krajinská cesta|           1038|  SSC - IVSC BA|            STAT|              106|           11|     bitúmenová|\n|  1238|  cesta I. triedy|      62|medzikrižovatkový|    Trnavský kraj|        Galanta|oba dopravné smer...|       nadregionálny|     Krajinská cesta|           1038|  SSC - IVSC BA|            STAT|                0|         null|     bitúmenová|\n|  1238|  cesta I. triedy|      62|medzikrižovatkový|    Trnavský kraj|        Galanta|oba dopravné smer...|       nadregionálny|     Krajinská cesta|           1038|  SSC - IVSC BA|            STAT|               82|           11|     bitúmenová|\n|  1238|  cesta I. triedy|      62|medzikrižovatkový|    Trnavský kraj|        Galanta|oba dopravné smer...|       nadregionálny|     Krajinská cesta|           1038|  SSC - IVSC BA|            STAT|              844|           11|     bitúmenová|\n|  1342| cesta II. triedy|     561|              lúč|    Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|Hlavná miestna cesta|             54|  SUC TTSK - DS|           TT SK|               12|          6,5|     bitúmenová|\n|  1342| cesta II. triedy|     561|              lúč|    Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|Hlavná miestna cesta|             54|  SUC TTSK - DS|           TT SK|               27|          6,5|     bitúmenová|\n|  1342| cesta II. triedy|     561|              lúč|    Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|Hlavná miestna cesta|             54|  SUC TTSK - DS|           TT SK|               15|          6,5|     bitúmenová|\n|  1580|cesta III. triedy|    1669|medzikrižovatkový|  Nitriansky kraj|  Zlaté Moravce|oba dopravné smer...|       podregionálny|     Krajinská cesta|           1671|   RSUC NR - NR|           NR SK|             1553|            5|     bitúmenová|\n|  1580|cesta III. triedy|    1669|medzikrižovatkový|  Nitriansky kraj|  Zlaté Moravce|oba dopravné smer...|       podregionálny|     Krajinská cesta|           1671|   RSUC NR - NR|           NR SK|              118|            7|     bitúmenová|\n+------+-----------------+--------+-----------------+-----------------+---------------+--------------------+--------------------+--------------------+---------------+---------------+----------------+-----------------+-------------+---------------+\nonly showing top 20 rows\n\ndetailedRoad: org.apache.spark.sql.DataFrame \u003d [usekID: int, TriedaCK: string ... 13 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://c30c9a123428:4040/jobs/job?id\u003d20"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1606819232102_-384063125",
      "id": "20201201-104032_1302110137",
      "dateCreated": "2020-12-01 10:40:32.102",
      "dateStarted": "2020-12-03 13:31:37.784",
      "dateFinished": "2020-12-03 13:31:39.404",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// vytvořit nový dataset, který bude agregovat data ze dvou datasetů najednou, z čehož jeden bude výsledkem předchozí agregace (critical)\nval secCriticalRating \u003d usefulSec.join(critical, usingColumns\u003dSeq(\"usekID\"), joinType \u003d \"right\")\nsecCriticalRating.show()",
      "user": "anonymous",
      "dateUpdated": "2020-12-03 13:31:39.486",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+----------------+--------+-----------------+---------------+---------------+--------------------+--------------------+--------------------+---------------+---------------+----------------+----------+-------------+------------------+-----------------+\n|usekID|        TriedaCK|Číslo CK|        Typ úseku|           Kraj|          Okres|       Dopravný smer|Funkčná klasifikácia|   StavebnaKategoria|prejazdovaDlzka|Spravca_Skratka|Vlastnik_Skratka|DatumZberu|MaxUciPriemer|        UciPriemer|           Rating|\n+------+----------------+--------+-----------------+---------------+---------------+--------------------+--------------------+--------------------+---------------+---------------+----------------+----------+-------------+------------------+-----------------+\n| 92191|rýchlostná cesta|  R00001|medzikrižovatkový|Nitriansky kraj|  Zlaté Moravce|smer dopravy súhl...|            diaľkový|            Diaľnica|           9433|            GRO|            STAT|  5.9.2019|           25|              22.5|nevyhovujúci stav|\n|289821|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|     Krajinská cesta|           1166|  SUC TTSK - DS|           TT SK| 26.8.2019|           80|              66.0|   havarijný stav|\n|289815|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|     Krajinská cesta|           1675|  SUC TTSK - DS|           TT SK| 26.8.2019|           69|              69.0|   havarijný stav|\n|926892|cesta II. triedy|     509|medzikrižovatkový|Nitriansky kraj|     Nové Zámky|oba dopravné smer...|          regionálny|     Krajinská cesta|            510|   RSUC NR - NZ|           NR SK| 20.9.2019|           46|43.666666666666664|   havarijný stav|\n|   918|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|     Krajinská cesta|           1382|  SUC TTSK - DS|           TT SK| 26.8.2019|           62|             53.75|   havarijný stav|\n|289823|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|Hlavná miestna cesta|            301|  SUC TTSK - DS|           TT SK| 26.8.2019|           62|              53.0|   havarijný stav|\n|418490|cesta II. triedy|     588|medzikrižovatkový|Nitriansky kraj|     Nové Zámky|oba dopravné smer...|          regionálny|Hlavná miestna cesta|            236|   RSUC NR - NZ|           NR SK| 4.12.2019|           45|              42.0|   havarijný stav|\n|  1417|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|     Krajinská cesta|           1380|  SUC TTSK - DS|           TT SK| 26.8.2019|           56|             35.25|   havarijný stav|\n|289674|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|Hlavná miestna cesta|            187|  SUC TTSK - DS|           TT SK| 26.8.2019|           72|              68.0|   havarijný stav|\n|416414|cesta II. triedy|     563|medzikrižovatkový|Nitriansky kraj|     Nové Zámky|oba dopravné smer...|          regionálny|Hlavná miestna cesta|            141|   RSUC NR - NZ|           NR SK| 19.9.2019|           24|              24.0|nevyhovujúci stav|\n|369212| cesta I. triedy|      63|medzikrižovatkový|Nitriansky kraj|        Komárno|oba dopravné smer...|       nadregionálny|     Krajinská cesta|            668|  SSC - IVSC BA|            STAT|  6.8.2019|           37|             33.75|   havarijný stav|\n|   914|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|     Krajinská cesta|           1582|  SUC TTSK - DS|           TT SK| 26.8.2019|           81|              71.5|   havarijný stav|\n|367279|cesta II. triedy|     563|medzikrižovatkový|Nitriansky kraj|        Komárno|oba dopravné smer...|          regionálny|     Krajinská cesta|            786|   RSUC NR - KN|           NR SK| 19.9.2019|           34|             27.75|nevyhovujúci stav|\n|   916|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|     Krajinská cesta|            182|  SUC TTSK - DS|           TT SK| 26.8.2019|           44|              44.0|   havarijný stav|\n|418437|cesta II. triedy|     509|medzikrižovatkový|Nitriansky kraj|     Nové Zámky|oba dopravné smer...|          regionálny|     Krajinská cesta|            785|   RSUC NR - NZ|           NR SK| 20.9.2019|           67|              53.0|   havarijný stav|\n|418515|cesta II. triedy|     563|medzikrižovatkový|Nitriansky kraj|     Nové Zámky|oba dopravné smer...|          regionálny|Hlavná miestna cesta|            125|   RSUC NR - NZ|           NR SK| 19.9.2019|           26|              26.0|nevyhovujúci stav|\n|289954|cesta II. triedy|     506|medzikrižovatkový|  Trnavský kraj|Dunajská Streda|oba dopravné smer...|          regionálny|     Krajinská cesta|           3526|  SUC TTSK - DS|           TT SK| 26.8.2019|           70|42.333333333333336|   havarijný stav|\n|369214| cesta I. triedy|      63|medzikrižovatkový|Nitriansky kraj|        Komárno|oba dopravné smer...|       nadregionálny|Hlavná miestna cesta|             88|  SSC - IVSC BA|            STAT|  6.8.2019|           36|              36.0|   havarijný stav|\n|367427|cesta II. triedy|     573|medzikrižovatkový|Nitriansky kraj|        Komárno|oba dopravné smer...|          regionálny|Hlavná miestna cesta|            122|   RSUC NR - KN|           NR SK| 19.9.2019|           27|              27.0|nevyhovujúci stav|\n|369219| cesta I. triedy|      63|medzikrižovatkový|Nitriansky kraj|        Komárno|oba dopravné smer...|       nadregionálny|     Krajinská cesta|            697|  SSC - IVSC BA|            STAT|  6.8.2019|           32|              29.0|nevyhovujúci stav|\n+------+----------------+--------+-----------------+---------------+---------------+--------------------+--------------------+--------------------+---------------+---------------+----------------+----------+-------------+------------------+-----------------+\nonly showing top 20 rows\n\nsecCriticalRating: org.apache.spark.sql.DataFrame \u003d [usekID: int, TriedaCK: string ... 14 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://c30c9a123428:4040/jobs/job?id\u003d21",
            "http://c30c9a123428:4040/jobs/job?id\u003d22",
            "http://c30c9a123428:4040/jobs/job?id\u003d23",
            "http://c30c9a123428:4040/jobs/job?id\u003d24",
            "http://c30c9a123428:4040/jobs/job?id\u003d25"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1606819633807_-192966610",
      "id": "20201201-104713_1093510427",
      "dateCreated": "2020-12-01 10:47:13.807",
      "dateStarted": "2020-12-03 13:31:39.526",
      "dateFinished": "2020-12-03 13:31:41.905",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "secCriticalRating.repartition(1).write\n.format(\"csv\")\n.option(\"sep\",\";\")\n.option(\"header\",\"true\")\n.save(\"secCriticalRating\")\ndetailedRoad.repartition(1).write\n.format(\"csv\")\n.option(\"sep\",\";\")\n.option(\"header\",\"true\")\n.save(\"detailedRoad\")",
      "user": "anonymous",
      "dateUpdated": "2020-12-03 13:36:54.889",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://c30c9a123428:4040/jobs/job?id\u003d26",
            "http://c30c9a123428:4040/jobs/job?id\u003d27",
            "http://c30c9a123428:4040/jobs/job?id\u003d28"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1606820047334_1745168194",
      "id": "20201201-105407_452540168",
      "dateCreated": "2020-12-01 10:54:07.334",
      "dateStarted": "2020-12-03 13:36:54.934",
      "dateFinished": "2020-12-03 13:37:00.755",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "",
      "user": "anonymous",
      "dateUpdated": "2020-12-01 11:45:12.466",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1606822687296_2100932865",
      "id": "20201201-113807_1493718313",
      "dateCreated": "2020-12-01 11:38:07.296",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Pothole repairs in Slovakia",
  "id": "2FS3RCH48",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}